# OKX 现货 AI 分析系统

> 多账号 · 三AI仲裁 · 链上巨鲸整合 · 自动执行 · 全审计系统

## 项目简介

OKX 现货 AI 分析系统是一个基于 TypeScript/Node.js 的自动化加密货币交易分析平台，支持 BTC/ETH/SOL 三个币种，通过三个 AI 模型并行分析并投票仲裁，结合链上巨鲸数据，实现智能交易决策。

## 系统架构

```
┌─────────────────────────────────────────────────────────────┐
│                    前端 Dashboard (:6000)                     │
├─────────────────────────────────────────────────────────────┤
│                      API Gateway / Auth                      │
├──────────┬──────────┬──────────┬──────────┬─────────────────┤
│ L1 数据层 │ L2 情报层 │ L3 分析层 │ L4 决策层 │ L5 执行层      │
├──────────┴──────────┴──────────┴──────────┴─────────────────┤
│              L6 审计层：全量日志 + 快照 + 回溯                  │
├─────────────────────────────────────────────────────────────┤
│              基础设施：DB │ Redis │ 监控 │ 告警               │
└─────────────────────────────────────────────────────────────┘
```

## 快速开始

### 环境要求
- Node.js 20 LTS
- PostgreSQL 16
- Redis 7

### 安装

```bash
# 复制环境变量模板
cp env.conf.template .env

# 编辑 .env 填写 API Keys
nano .env

# 安装依赖
npm install

# 初始化数据库
npx prisma generate
npx prisma migrate deploy

# 构建
npm run build

# 启动
npm start
```

### Docker 部署

```bash
docker-compose up -d
```

## API 接口

| 方法 | 路径 | 描述 |
|------|------|------|
| POST | /api/auth/login | 登录获取JWT |
| GET | /api/accounts | 账户列表 |
| POST | /api/accounts | 添加账户 |
| GET | /api/analysis | 分析结果列表 |
| GET | /api/orders | 订单列表 |
| GET | /api/audit | 审计日志 |
| GET | /api/health | 系统健康状态 |
| GET | /api/config/coins | 币种配置 |
| GET | /api/config/risk-rules | 风控规则 |

## 三AI模型配置

| AI | 普通模型 | 高级模型 |
|----|---------|---------|
| AI-1 (DeepSeek) | deepseek-chat ($0.0001/1k) | deepseek-chat |
| AI-2 (OpenAI) | gpt-4o-mini ($0.00015/1k) | gpt-4o ($0.005/1k) |
| AI-3 (Claude) | claude-3-5-haiku ($0.0001/1k) | claude-3-5-sonnet ($0.003/1k) |

## 风控级别

| 级别 | 触发条件 | 最大仓位 | 批次 | 冷却 |
|------|---------|---------|------|------|
| P0 | 价格5分钟变化>3%, 巨鲸评分>85 | 3% | 3批×10s | 300s |
| P1 | 结构突破, 巨鲸评分60-85 | 5% | 2批 | 120s |
| P2 | 常规趋势信号 | 8% | 1批 | 60s |

## 数据字段

系统实现了200+个数据字段，详见 [data-fields.md](./data-fields.md)

## 监控

- 系统健康评分: 0-100
- ≥80: 正常运行
- 50-80: 暂停执行，仅通知
- <50: 紧急停止所有操作

## 安全

- API Keys 使用 AES-256 加密存储
- JWT 认证，30分钟过期
- 所有操作写入不可篡改的 SHA-256 哈希链审计日志
